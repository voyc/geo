select case 
when pop>40000000 then 400
when pop>39900000 then 399
when pop>39800000 then 398
when pop>39700000 then 397
when pop>39600000 then 396
when pop>39500000 then 395
when pop>39400000 then 394
when pop>39300000 then 393
when pop>39200000 then 392
when pop>39100000 then 391
when pop>39000000 then 390
when pop>38900000 then 389
when pop>38800000 then 388
when pop>38700000 then 387
when pop>38600000 then 386
when pop>38500000 then 385
when pop>38400000 then 384
when pop>38300000 then 383
when pop>38200000 then 382
when pop>38100000 then 381
when pop>38000000 then 380
when pop>37900000 then 379
when pop>37800000 then 378
when pop>37700000 then 377
when pop>37600000 then 376
when pop>37500000 then 375
when pop>37400000 then 374
when pop>37300000 then 373
when pop>37200000 then 372
when pop>37100000 then 371
when pop>37000000 then 370
when pop>36900000 then 369
when pop>36800000 then 368
when pop>36700000 then 367
when pop>36600000 then 366
when pop>36500000 then 365
when pop>36400000 then 364
when pop>36300000 then 363
when pop>36200000 then 362
when pop>36100000 then 361
when pop>36000000 then 360
when pop>35900000 then 359
when pop>35800000 then 358
when pop>35700000 then 357
when pop>35600000 then 356
when pop>35500000 then 355
when pop>35400000 then 354
when pop>35300000 then 353
when pop>35200000 then 352
when pop>35100000 then 351
when pop>35000000 then 350
when pop>34900000 then 349
when pop>34800000 then 348
when pop>34700000 then 347
when pop>34600000 then 346
when pop>34500000 then 345
when pop>34400000 then 344
when pop>34300000 then 343
when pop>34200000 then 342
when pop>34100000 then 341
when pop>34000000 then 340
when pop>33900000 then 339
when pop>33800000 then 338
when pop>33700000 then 337
when pop>33600000 then 336
when pop>33500000 then 335
when pop>33400000 then 334
when pop>33300000 then 333
when pop>33200000 then 332
when pop>33100000 then 331
when pop>33000000 then 330
when pop>32900000 then 329
when pop>32800000 then 328
when pop>32700000 then 327
when pop>32600000 then 326
when pop>32500000 then 325
when pop>32400000 then 324
when pop>32300000 then 323
when pop>32200000 then 322
when pop>32100000 then 321
when pop>32000000 then 320
when pop>31900000 then 319
when pop>31800000 then 318
when pop>31700000 then 317
when pop>31600000 then 316
when pop>31500000 then 315
when pop>31400000 then 314
when pop>31300000 then 313
when pop>31200000 then 312
when pop>31100000 then 311
when pop>31000000 then 310
when pop>30900000 then 309
when pop>30800000 then 308
when pop>30700000 then 307
when pop>30600000 then 306
when pop>30500000 then 305
when pop>30400000 then 304
when pop>30300000 then 303
when pop>30200000 then 302
when pop>30100000 then 301
when pop>30000000 then 300
when pop>29900000 then 299
when pop>29800000 then 298
when pop>29700000 then 297
when pop>29600000 then 296
when pop>29500000 then 295
when pop>29400000 then 294
when pop>29300000 then 293
when pop>29200000 then 292
when pop>29100000 then 291
when pop>29000000 then 290
when pop>28900000 then 289
when pop>28800000 then 288
when pop>28700000 then 287
when pop>28600000 then 286
when pop>28500000 then 285
when pop>28400000 then 284
when pop>28300000 then 283
when pop>28200000 then 282
when pop>28100000 then 281
when pop>28000000 then 280
when pop>27900000 then 279
when pop>27800000 then 278
when pop>27700000 then 277
when pop>27600000 then 276
when pop>27500000 then 275
when pop>27400000 then 274
when pop>27300000 then 273
when pop>27200000 then 272
when pop>27100000 then 271
when pop>27000000 then 270
when pop>26900000 then 269
when pop>26800000 then 268
when pop>26700000 then 267
when pop>26600000 then 266
when pop>26500000 then 265
when pop>26400000 then 264
when pop>26300000 then 263
when pop>26200000 then 262
when pop>26100000 then 261
when pop>26000000 then 260
when pop>25900000 then 259
when pop>25800000 then 258
when pop>25700000 then 257
when pop>25600000 then 256
when pop>25500000 then 255
when pop>25400000 then 254
when pop>25300000 then 253
when pop>25200000 then 252
when pop>25100000 then 251
when pop>25000000 then 250
when pop>24900000 then 249
when pop>24800000 then 248
when pop>24700000 then 247
when pop>24600000 then 246
when pop>24500000 then 245
when pop>24400000 then 244
when pop>24300000 then 243
when pop>24200000 then 242
when pop>24100000 then 241
when pop>24000000 then 240
when pop>23900000 then 239
when pop>23800000 then 238
when pop>23700000 then 237
when pop>23600000 then 236
when pop>23500000 then 235
when pop>23400000 then 234
when pop>23300000 then 233
when pop>23200000 then 232
when pop>23100000 then 231
when pop>23000000 then 230
when pop>22900000 then 229
when pop>22800000 then 228
when pop>22700000 then 227
when pop>22600000 then 226
when pop>22500000 then 225
when pop>22400000 then 224
when pop>22300000 then 223
when pop>22200000 then 222
when pop>22100000 then 221
when pop>22000000 then 220
when pop>21900000 then 219
when pop>21800000 then 218
when pop>21700000 then 217
when pop>21600000 then 216
when pop>21500000 then 215
when pop>21400000 then 214
when pop>21300000 then 213
when pop>21200000 then 212
when pop>21100000 then 211
when pop>21000000 then 210
when pop>20900000 then 209
when pop>20800000 then 208
when pop>20700000 then 207
when pop>20600000 then 206
when pop>20500000 then 205
when pop>20400000 then 204
when pop>20300000 then 203
when pop>20200000 then 202
when pop>20100000 then 201
when pop>20000000 then 200
when pop>19900000 then 199
when pop>19800000 then 198
when pop>19700000 then 197
when pop>19600000 then 196
when pop>19500000 then 195
when pop>19400000 then 194
when pop>19300000 then 193
when pop>19200000 then 192
when pop>19100000 then 191
when pop>19000000 then 190
when pop>18900000 then 189
when pop>18800000 then 188
when pop>18700000 then 187
when pop>18600000 then 186
when pop>18500000 then 185
when pop>18400000 then 184
when pop>18300000 then 183
when pop>18200000 then 182
when pop>18100000 then 181
when pop>18000000 then 180
when pop>17900000 then 179
when pop>17800000 then 178
when pop>17700000 then 177
when pop>17600000 then 176
when pop>17500000 then 175
when pop>17400000 then 174
when pop>17300000 then 173
when pop>17200000 then 172
when pop>17100000 then 171
when pop>17000000 then 170
when pop>16900000 then 169
when pop>16800000 then 168
when pop>16700000 then 167
when pop>16600000 then 166
when pop>16500000 then 165
when pop>16400000 then 164
when pop>16300000 then 163
when pop>16200000 then 162
when pop>16100000 then 161
when pop>16000000 then 160
when pop>15900000 then 159
when pop>15800000 then 158
when pop>15700000 then 157
when pop>15600000 then 156
when pop>15500000 then 155
when pop>15400000 then 154
when pop>15300000 then 153
when pop>15200000 then 152
when pop>15100000 then 151
when pop>15000000 then 150
when pop>14900000 then 149
when pop>14800000 then 148
when pop>14700000 then 147
when pop>14600000 then 146
when pop>14500000 then 145
when pop>14400000 then 144
when pop>14300000 then 143
when pop>14200000 then 142
when pop>14100000 then 141
when pop>14000000 then 140
when pop>13900000 then 139
when pop>13800000 then 138
when pop>13700000 then 137
when pop>13600000 then 136
when pop>13500000 then 135
when pop>13400000 then 134
when pop>13300000 then 133
when pop>13200000 then 132
when pop>13100000 then 131
when pop>13000000 then 130
when pop>12900000 then 129
when pop>12800000 then 128
when pop>12700000 then 127
when pop>12600000 then 126
when pop>12500000 then 125
when pop>12400000 then 124
when pop>12300000 then 123
when pop>12200000 then 122
when pop>12100000 then 121
when pop>12000000 then 120
when pop>11900000 then 119
when pop>11800000 then 118
when pop>11700000 then 117
when pop>11600000 then 116
when pop>11500000 then 115
when pop>11400000 then 114
when pop>11300000 then 113
when pop>11200000 then 112
when pop>11100000 then 111
when pop>11000000 then 110
when pop>10900000 then 109
when pop>10800000 then 108
when pop>10700000 then 107
when pop>10600000 then 106
when pop>10500000 then 105
when pop>10400000 then 104
when pop>10300000 then 103
when pop>10200000 then 102
when pop>10100000 then 101
when pop>10000000 then 100
when pop>9900000 then 99
when pop>9800000 then 98
when pop>9700000 then 97
when pop>9600000 then 96
when pop>9500000 then 95
when pop>9400000 then 94
when pop>9300000 then 93
when pop>9200000 then 92
when pop>9100000 then 91
when pop>9000000 then 90
when pop>8900000 then 89
when pop>8800000 then 88
when pop>8700000 then 87
when pop>8600000 then 86
when pop>8500000 then 85
when pop>8400000 then 84
when pop>8300000 then 83
when pop>8200000 then 82
when pop>8100000 then 81
when pop>8000000 then 80
when pop>7900000 then 79
when pop>7800000 then 78
when pop>7700000 then 77
when pop>7600000 then 76
when pop>7500000 then 75
when pop>7400000 then 74
when pop>7300000 then 73
when pop>7200000 then 72
when pop>7100000 then 71
when pop>7000000 then 70
when pop>6900000 then 69
when pop>6800000 then 68
when pop>6700000 then 67
when pop>6600000 then 66
when pop>6500000 then 65
when pop>6400000 then 64
when pop>6300000 then 63
when pop>6200000 then 62
when pop>6100000 then 61
when pop>6000000 then 60
when pop>5900000 then 59
when pop>5800000 then 58
when pop>5700000 then 57
when pop>5600000 then 56
when pop>5500000 then 55
when pop>5400000 then 54
when pop>5300000 then 53
when pop>5200000 then 52
when pop>5100000 then 51
when pop>5000000 then 50
when pop>4900000 then 49
when pop>4800000 then 48
when pop>4700000 then 47
when pop>4600000 then 46
when pop>4500000 then 45
when pop>4400000 then 44
when pop>4300000 then 43
when pop>4200000 then 42
when pop>4100000 then 41
when pop>4000000 then 40
when pop>3900000 then 39
when pop>3800000 then 38
when pop>3700000 then 37
when pop>3600000 then 36
when pop>3500000 then 35
when pop>3400000 then 34
when pop>3300000 then 33
when pop>3200000 then 32
when pop>3100000 then 31
when pop>3000000 then 30
when pop>2900000 then 29
when pop>2800000 then 28
when pop>2700000 then 27
when pop>2600000 then 26
when pop>2500000 then 25
when pop>2400000 then 24
when pop>2300000 then 23
when pop>2200000 then 22
when pop>2100000 then 21
when pop>2000000 then 20
when pop>1900000 then 19
when pop>1800000 then 18
when pop>1700000 then 17
when pop>1600000 then 16
when pop>1500000 then 15
when pop>1400000 then 14
when pop>1300000 then 13
when pop>1200000 then 12
when pop>1100000 then 11
when pop>1000000 then 10
when pop>900000 then 9
when pop>800000 then 8
when pop>700000 then 7
when pop>600000 then 6
when pop>500000 then 5
when pop>400000 then 4
when pop>300000 then 3
when pop>200000 then 2
when pop>100000 then 1
else 0
end as scalerank, 
count(*) as freq,
sum(pop) as tpop
from plunder.cities
group by scalerank
order by scalerank desc;

